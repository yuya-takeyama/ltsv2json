#!/usr/bin/env ruby
# coding: utf-8

lib = File.expand_path('../../lib', __FILE__)
$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)

require 'json'
require 'ltsv2json/version'

trap('INT') { exit 130 }

inputs = ARGV[0] ? ARGV.map {|f| open f } : [STDIN]
inputs.each do |input|
  input.each_line do |line|
    puts JSON.dump(Hash[line.chop.split("\t").map{|field| field.split ':', 2}.to_a])
  end
end
